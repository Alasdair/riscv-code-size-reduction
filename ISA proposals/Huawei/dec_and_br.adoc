= Combined decrement and branch

This example is from /lib/riscv64-linux-gnu/libgcc_s.so.1 in the RV64 Debian distro

[source,sourceCode,text]
----
    d124:	6094                	ld	a3,0(s1)
    d126:	01093783          	ld	a5,16(s2)
    d12a:	8722                	mv	a4,s0
    d12c:	00d93823          	sd	a3,16(s2)
    d130:	e09c                	sd	a5,0(s1)
    d132:	4681                	li	a3,0
    d134:	864e                	mv	a2,s3
    d136:	85d6                	mv	a1,s5
    d138:	8552                	mv	a0,s4
    d13a:	347d                	addiw	s0,s0,-1 ;# loop counter 1
    d13c:	ef1ff0ef          	jal	ra,d02c <_Unwind_Backtrace@@GCC_3.3+0xf0>
    d140:	14e1                	addi	s1,s1,-8 ;# loop counter 2
    d142:	f06d                	bnez	s0,d124 <_Unwind_Backtrace@@GCC_3.3+0x1e8>
----

The proposal is for 16-bit encodings for `c.dec[1248]bgez`:

[source,sourceCode,text]
----
dec1bgez rd', #offset; # rd' = rd' - 1; bge rd', zero, -#offset;
dec2bgez rd', #offset; # rd' = rd' - 2; bge rd', zero, -#offset;
dec4bgez rd', #offset; # rd' = rd' - 4; bge rd', zero, -#offset;
dec8bgez rd', #offset; # rd' = rd' - 8; bge rd', zero, -#offset;
----

This reduces the loop by one 16-bit instruction to:

[source,sourceCode,text]
----
    d124:	6094                	ld	a3,0(s1)
    d126:	01093783          	ld	a5,16(s2)
    d12a:	8722                	mv	a4,s0
    d12c:	00d93823          	sd	a3,16(s2)
    d130:	e09c                	sd	a5,0(s1)
    d132:	4681                	li	a3,0
    d134:	864e                	mv	a2,s3
    d136:	85d6                	mv	a1,s5
    d138:	8552                	mv	a0,s4
    d13c:	ef1ff0ef          	jal	ra,d02c <_Unwind_Backtrace@@GCC_3.3+0xf0>
    d140:	14e1                	addi	s1,s1,-8 ;# loop counter 2
    d142:	f06d                	dec1bgez	s0,d124 <_Unwind_Backtrace@@GCC_3.3+0x1e8>
----

There will be other cases where the second loop counter can be removed. I'll update this when I find more cases.
No benchmarking done yet.
